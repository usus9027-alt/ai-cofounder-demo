<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Co-founder Platform</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/fabric@5.3.0/dist/fabric.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .canvas-container {
            background: #f8fafc;
            border: 2px dashed #cbd5e1;
        }
        .phase-active {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
        }
        .object-problem { background: #fef2f2; border-color: #fca5a5; }
        .object-insight { background: #eff6ff; border-color: #93c5fd; }
        .object-persona { background: #f0fdf4; border-color: #86efac; }
        .object-solution { background: #faf5ff; border-color: #c4b5fd; }
        .object-milestone { background: #fffbeb; border-color: #fcd34d; }
        .object-note { background: #f9fafb; border-color: #d1d5db; }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="gradient-bg text-white shadow-lg">
        <div class="container mx-auto px-4 py-4">
            <div class="flex items-center justify-center">
                <div class="flex items-center space-x-3">
                    <i class="fas fa-robot text-2xl"></i>
                    <h1 class="text-xl font-bold">AI Co-founder Platform</h1>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="flex h-screen">
        <!-- Chat Panel - 1/3 —ç–∫—Ä–∞–Ω–∞ -->
        <div class="w-1/3 bg-white border-r flex flex-col">
            <div class="p-4 border-b">
                <h3 class="text-lg font-semibold flex items-center">
                    <i class="fas fa-comments mr-2 text-blue-600"></i>
                    AI –ß–∞—Ç
                </h3>
            </div>
            <div class="flex-1 overflow-y-auto p-4 space-y-4">
                <div class="bg-blue-50 p-3 rounded-lg">
                    <div class="flex items-start space-x-2">
                        <i class="fas fa-robot text-blue-600 mt-1"></i>
                        <div>
                            <p class="text-sm text-gray-700">–ü—Ä–∏–≤–µ—Ç! –Ø —Ç–≤–æ–π AI-–∫–æ—Ñ–∞—É–Ω–¥–µ—Ä. –†–∞—Å—Å–∫–∞–∂–∏ –º–Ω–µ –æ —Å–≤–æ–µ–π –∏–¥–µ–µ, –∏ —è –ø–æ–º–æ–≥—É —Ç–µ–±–µ –ø—Ä–æ–π—Ç–∏ –ø—É—Ç—å –æ—Ç –∏–¥–µ–∏ –¥–æ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–¥—É–∫—Ç–∞!</p>
                        </div>
                    </div>
                </div>
                <div id="chatMessages" class="space-y-4">
                    <!-- –°–æ–æ–±—â–µ–Ω–∏—è —á–∞—Ç–∞ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è —Å—é–¥–∞ -->
                </div>
            </div>
            <div class="p-4 border-t">
                <div class="flex space-x-2">
                    <input type="text" id="chatInput" placeholder="–û–ø–∏—à–∏—Ç–µ –≤–∞—à—É –∏–¥–µ—é..." 
                           class="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <button id="sendBtn" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Canvas Panel - 2/3 —ç–∫—Ä–∞–Ω–∞ -->
        <div class="w-2/3 bg-white flex flex-col">
            <div class="p-4 border-b">
                <h3 class="text-lg font-semibold flex items-center">
                    <i class="fas fa-palette mr-2 text-green-600"></i>
                    Canvas –î–æ—Å–∫–∞
                </h3>
            </div>
            <div class="flex-1 p-4">
                <div id="canvasContainer" class="w-full h-full rounded-lg relative border-2 border-dashed border-gray-300">
                    <canvas id="canvas" class="w-full h-full"></canvas>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden">
        <div class="bg-white p-6 rounded-lg shadow-lg">
            <div class="flex items-center space-x-3">
                <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
                <span class="text-lg">AI –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç...</span>
            </div>
        </div>
    </div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Canvas
        let canvas;
        let selectedObjectType = 'note';

        function initCanvas() {
            const canvasContainer = document.getElementById('canvasContainer');
            const containerWidth = canvasContainer.clientWidth - 20; // –æ—Ç—Å—Ç—É–ø—ã
            const containerHeight = canvasContainer.clientHeight - 20;
            
            canvas = new fabric.Canvas('canvas', {
                width: containerWidth,
                height: containerHeight,
                backgroundColor: '#f8fafc'
            });
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ –Ω–∞ Canvas
        function createCanvasObject(type, content, x = 100, y = 100) {
            const colors = {
                problem: '#fef2f2',
                insight: '#eff6ff',
                persona: '#f0fdf4',
                solution: '#faf5ff',
                milestone: '#fffbeb',
                note: '#f9fafb'
            };

            const icons = {
                problem: '‚ö†Ô∏è',
                insight: 'üí°',
                persona: 'üë§',
                solution: 'üîß',
                milestone: 'üèÅ',
                note: 'üìù'
            };

            const rect = new fabric.Rect({
                left: x,
                top: y,
                width: 200,
                height: 120,
                fill: colors[type] || colors.note,
                stroke: '#d1d5db',
                strokeWidth: 2,
                rx: 8,
                ry: 8
            });

            const text = new fabric.Text(`${icons[type]} ${content}`, {
                left: x + 10,
                top: y + 10,
                fontSize: 14,
                fill: '#374151',
                width: 180,
                textAlign: 'left'
            });

            const group = new fabric.Group([rect, text], {
                left: x,
                top: y
            });

            canvas.add(group);
            canvas.renderAll();
        }

        // –ß–∞—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
        document.getElementById('sendBtn').addEventListener('click', sendMessage);
        document.getElementById('chatInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') sendMessage();
        });

        function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            if (!message) return;

            addMessageToChat('user', message);
            input.value = '';

            // –ò–º–∏—Ç–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ AI
            setTimeout(() => {
                const aiResponse = generateAIResponse(message);
                addMessageToChat('ai', aiResponse);
                
                // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞ Canvas
                if (shouldCreateCanvasObject(message)) {
                    createCanvasObject(selectedObjectType, extractKeyContent(message));
                }
            }, 1000);
        }

        function addMessageToChat(sender, message) {
            const chatMessages = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            
            if (sender === 'user') {
                messageDiv.className = 'bg-gray-100 p-3 rounded-lg ml-8';
                messageDiv.innerHTML = `
                    <div class="flex items-start space-x-2">
                        <i class="fas fa-user text-gray-600 mt-1"></i>
                        <p class="text-sm text-gray-700">${message}</p>
                    </div>
                `;
            } else {
                messageDiv.className = 'bg-blue-50 p-3 rounded-lg';
                messageDiv.innerHTML = `
                    <div class="flex items-start space-x-2">
                        <i class="fas fa-robot text-blue-600 mt-1"></i>
                        <div>
                            <p class="text-sm text-gray-700">${message}</p>
                        </div>
                    </div>
                `;
            }
            
            chatMessages.appendChild(messageDiv);
            
            // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ –ø–æ—Å–ª–µ–¥–Ω–µ–º—É —Å–æ–æ–±—â–µ–Ω–∏—é
            const chatContainer = chatMessages.parentElement;
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        function generateAIResponse(userMessage) {
            const responses = [
                "–û—Ç–ª–∏—á–Ω–∞—è –∏–¥–µ—è! –î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –µ—ë –ø–æ–¥—Ä–æ–±–Ω–µ–µ. –ö–∞–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –æ–Ω–∞ —Ä–µ—à–∞–µ—Ç?",
                "–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ! –†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –±–æ–ª—å—à–µ –æ –≤–∞—à–µ–π —Ü–µ–ª–µ–≤–æ–π –∞—É–¥–∏—Ç–æ—Ä–∏–∏.",
                "–•–æ—Ä–æ—à–∞—è –º—ã—Å–ª—å! –î–∞–≤–∞–π—Ç–µ —Å–æ–∑–¥–∞–¥–∏–º –ø–ª–∞–Ω —Ä–∞–∑–≤–∏—Ç–∏—è —ç—Ç–æ–π –∏–¥–µ–∏.",
                "–û—Ç–ª–∏—á–Ω–æ! –¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤ –Ω–∞ —Ä—ã–Ω–∫–µ.",
                "–ü–æ–Ω—è—Ç–Ω–æ! –î–∞–≤–∞–π—Ç–µ –æ–ø—Ä–µ–¥–µ–ª–∏–º –∫–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –≤–∞—à–µ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞.",
                "–•–æ—Ä–æ—à–æ! –¢–µ–ø–µ—Ä—å –Ω—É–∂–Ω–æ –ø–æ–¥—É–º–∞—Ç—å –æ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏.",
                "–û—Ç–ª–∏—á–Ω–æ! –î–∞–≤–∞–π—Ç–µ –ø–æ–¥–≥–æ—Ç–æ–≤–∏–º –ø–ª–∞–Ω –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–¥—É–∫—Ç–∞.",
                "–ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ! –í–∞—à–∞ –∏–¥–µ—è –≥–æ—Ç–æ–≤–∞ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏!"
            ];
            return responses[Math.floor(Math.random() * responses.length)];
        }

        function shouldCreateCanvasObject(message) {
            const keywords = ['–ø—Ä–æ–±–ª–µ–º–∞', '–∏–¥–µ—è', '—Ä–µ—à–µ–Ω–∏–µ', '–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å', '–∞–Ω–∞–ª–∏–∑', '–∏–Ω—Å–∞–π—Ç'];
            return keywords.some(keyword => message.toLowerCase().includes(keyword));
        }

        function extractKeyContent(message) {
            // –ü—Ä–æ—Å—Ç–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–ª—é—á–µ–≤–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
            return message.length > 50 ? message.substring(0, 50) + '...' : message;
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ Canvas
        function autoSaveCanvas() {
            const canvasData = JSON.stringify(canvas.toJSON());
            localStorage.setItem('ai-cofounder-canvas', canvasData);
        }

        // –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥
        setInterval(autoSaveCanvas, 5000);

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ Canvas
        function loadCanvas() {
            const saved = localStorage.getItem('ai-cofounder-canvas');
            if (saved) {
                canvas.loadFromJSON(saved, () => {
                    canvas.renderAll();
                });
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', () => {
            initCanvas();
            loadCanvas();
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞
            window.addEventListener('resize', () => {
                setTimeout(() => {
                    const canvasContainer = document.getElementById('canvasContainer');
                    const containerWidth = canvasContainer.clientWidth - 20;
                    const containerHeight = canvasContainer.clientHeight - 20;
                    
                    canvas.setDimensions({
                        width: containerWidth,
                        height: containerHeight
                    });
                }, 100);
            });
        });

        function showLoading() {
            document.getElementById('loadingOverlay').classList.remove('hidden');
        }

        function hideLoading() {
            document.getElementById('loadingOverlay').classList.add('hidden');
        }
    </script>
</body>
</html>
